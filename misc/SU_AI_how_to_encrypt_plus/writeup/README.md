# WP

```python
class Net(nn.Module):

    def __init__(self):
        super(Net, self).__init__()
        self.linear = nn.Linear(n, n*n)
        self.conv=nn.Conv2d(1, 1, (2, 2), stride=1,padding=1)
        self.conv1=nn.Conv2d(1, 1, (3, 3), stride=3)

    def forward(self, x):
        x = x.view(1,1,3, 3*n)
        x = self.conv1(x)
        x = x.view(n)
        x = self.linear(x)
        x = x.view(1, 1, n, n)
        x=self.conv(x)
        return x
```

可以看到模型总共有三层，第一层为卷积层，第二层为线性层，第三层为卷积层。由于题目给了密文所以我们从下往上慢慢逆向上去。

## 第三层

一般情况下卷积层是不可逆的，这是因为大部分的卷积层的卷积操作都会使得信息缺失，例如48\*48的输入，到了输出变成了46\*46这样是没有稳定可行的逆向方法，但是在这题中，此层有padding，这也就导致了信息并不会缺失，结合卷积的实际操作，我们可以从四个角开始破解，因为四个角中均会出现2*2卷积核中有三个是0，那么这时候就很好逆推。

## 第二层

这一层是一个线性层，本质是乘上了一个矩阵，只需要求一下逆即可。

## 第一层

这一层是看起来存在信息缺失的，但是实际上并不会缺失，观察到输入的每个数字均为0/1，而且卷积核权重为1、2、4、8、16、32、64、128、256，可以发现这一层实际上就是把九个0/1，从二进制合并转成十进制，所以我们只需要将密文按位取出，然后放到指定地方即可。