from pwn import *

ans1= 5187194916269281626745037767173603231415609416867392305123980779008208434929772707208280961033461202017912158717330582864407354016216588525013011512281899797168502525218442665812072331678670374565155696423838506880584951286690822823790829725973699338105359972751617500846560968150418811996609
ans2= '1440354387400113353318275132419054375891245413681864837390427511212805748408072838847944629793120889446685643108530381465382074956451566809039119353657601240377236701038904980199109550001860607309184336719930229935342817546146083848277758428344831968440238907935894338978800768226766379, 9391500403903773267688655787670246245493629218171544262747638036518222364768797479813561509116827252710188014736501391120827705790025300419608858224262849244058466770043809014864245428958116544162335497194996709759345801074510016208346248254582570123358164225821298549533282498545808644,1054210182683112310528012408530531909717229064191793536540847847817849001214642792626066010344383473173101972948978951703027097154519698536728956323881063669558925110120619283730835864056709609662983759100063333396875182094245046315497525532634764115913236450532733839386139526489824351'
io = remote('1.95.46.185',int(10006))
io.sendlineafter(b'[+] Plz Tell Me your number: ',str(ans1).encode())
io.sendlineafter(b'[+] Plz give Me your a, b, c: ',ans2.encode())
# io.interactive()
io.recvuntil(b"Let's play the game3!")
io.recvline()
out = io.recvline().strip().decode()
print(out)
print('\n')
precision = 999
C = ComplexField(precision)
out = sage_eval(out, locals={"I": C.gen()})
print(out)
z = io.recvline().strip().decode()
z = sage_eval(z, locals={"I": C.gen()})

z1,w1 = out[0]
z2,w2 = out[1]
z3,w3 = out[2]

A = (w1-w2)*(z-z2)*(z1-z3)
B = (w1-w3)*(z1-z2)*(z-z3)
# 利用复比不变性计算kw
kw = ((w3*A) - (w2*B)) / (A-B)
io.sendlineafter(b'[+] Plz Tell Me your answer: ',str(kw).encode())
io.interactive()
